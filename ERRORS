-- Create a new tablespace for the project
CREATE TABLESPACE QUIZ_DATA
  DATAFILE 'C:/Chetan/Development/DB/QUIZ_DATA.dbf'
  SIZE 100M AUTOEXTEND ON; 

ALTER SESSION SET "_ORACLE_SCRIPT"=true;

-- Create Schema Owner (Schema where all objects will be created)
CREATE USER QUIZ_SCHEMA_OWNER IDENTIFIED BY "QUIZSO_pwd"
  DEFAULT TABLESPACE QUIZ_DATA
  TEMPORARY TABLESPACE temp
  QUOTA UNLIMITED ON QUIZ_DATA;

-- Create Application User (Spring Boot will connect using this user)
CREATE USER QUIZ_APP_USER IDENTIFIED BY "QUIZCU_pwd"
  DEFAULT TABLESPACE QUIZ_DATA
  TEMPORARY TABLESPACE temp;

-- Grant all required privileges to Schema Owner
GRANT CONNECT, RESOURCE, CREATE SESSION, CREATE TABLE, CREATE VIEW, CREATE SEQUENCE, CREATE TRIGGER, CREATE PROCEDURE, CREATE SYNONYM TO QUIZ_SCHEMA_OWNER;

-- Allow the Application User to use the schema objects
GRANT CONNECT, RESOURCE, CREATE SESSION TO QUIZ_APP_USER;
GRANT ALL PRIVILEGES ON QUIZ_SCHEMA_OWNER TO QUIZ_APP_USER;

-- Allow QUIZ_APP_USER to access and modify objects in QUIZ_SCHEMA_OWNER
GRANT SELECT, INSERT, UPDATE, DELETE, ALTER, INDEX ON QUIZ_SCHEMA_OWNER TO QUIZ_APP_USER;

-- Set unlimited quota for QUIZ_APP_USER on tablespace
ALTER USER QUIZ_APP_USER QUOTA UNLIMITED ON QUIZ_DATA;

-- Verify current schema (Optional)
SELECT SYS_CONTEXT('USERENV', 'CURRENT_SCHEMA') FROM DUAL;
