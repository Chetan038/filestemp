CREATE TABLESPACE INT_DATA
  DATAFILE 'C:/Chetan/Development/DB/INT_DATA.dbf'
  SIZE 100M AUTOEXTEND ON; 
  
  
alter session set "_ORACLE_SCRIPT"=true;

-- Part 1: Create User to serve as the 'Schema Owner' of all the objects
CREATE USER INTSO IDENTIFIED BY "INTSO_pwd"
  DEFAULT TABLESPACE users
  TEMPORARY TABLESPACE temp
  QUOTA UNLIMITED ON users;


-- Part 2: Create Application Connect User as one with Read-write access to the schema
CREATE USER INTCU IDENTIFIED BY "INTCU_pwd"
  DEFAULT TABLESPACE users
  TEMPORARY TABLESPACE temp;
  
ALTER USER INTSO quota unlimited on INT_DATA;


-- ROLES

--Part 1: Create application role with write access
CREATE ROLE INT_ROLE_CU_RW NOT IDENTIFIED;
GRANT CREATE SESSION TO INT_ROLE_CU_RW;
GRANT CONNECT TO INT_ROLE_CU_RW;

-- Assign ROLES
GRANT INT_ROLE_CU_RW TO INTCU;


-- CREATE APPUSER TABLE scripts



CREATE SEQUENCE INTSO.APP_USER_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
GRANT SELECT ON INTSO.APP_USER_SEQ TO INT_ROLE_CU_RW;

CREATE TABLE INTSO.APP_USER
(
USER_SEQ_ID 	NUMBER(38,0) NOT NULL,
EMAIL_ADDRESS 	VARCHAR2(255)NOT NULL,
PASSWORD 		VARCHAR2(255)NOT NULL,
USER_NAME 		VARCHAR2(255)NOT NULL,
CONSTRAINT APP_USER_PK PRIMARY KEY(USER_SEQ_ID)
)TABLESPACE INT_DATA;

GRANT SELECT, INSERT, UPDATE, DELETE ON INTSO.APP_USER TO INT_ROLE_CU_RW;

-- CREATE employee TABLE scripts

CREATE TABLE INTSO.EMPLOYEE(
EMP_SEQ_ID NUMBER(38,0),
EMP VARCHAR2(255),
EMP_NAME VARCHAR2(255),
EMP_DEPT_ID NUMBER(38,0),
EMP_PER_DAY_SAL NUMBER(10,2),
STATUS VARCHAR2(50),
DT_CREATED TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP,
CREATED_BY NUMBER(38,0),
DT_UPDATED TIMESTAMP WITH TIME ZONE,
CONSTRAINT EMPLOYEE_PK PRIMARY KEY (EMP_SEQ_ID),
CONSTRAINT EMPLOYEE_CREATED_BY_FK FOREIGN KEY(CREATED_BY) REFERENCES INTSO.APP_USER(USER_SEQ_ID)
)TABLESPACE INT_DATA;

CREATE SEQUENCE INTSO.EMP_SEQ_ID START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

GRANT SELECT,INSERT,UPDATE,DELETE ON INTSO.EMPLOYEE TO INT_ROLE_CU_RW;

insert into INTSO.APP_USER values(123,'ctidke2@gmail.com','123zert','chetan');

select * from INTSO.APP_USER;

CREATE TABLE INTSO.DEPARTMENT (EMP_DEPT_ID NUMBER(38,0) PRIMARY KEY,
DEPT_NAME VARCHAR2(255) UNIQUE NOT NULL
);

insert into INTSO.APP_USER values(123,'ctidke2@gmail.com','123zert','chetan');
insert into INTSO.EMPLOYEE values(123,'ctidke2@gmail.com','123zert','chetan');

SELECT * FROM INTSO.EMPLOYEE;

ALTER TABLE INTSO.EMPLOYEE ADD UPDATED_BY NUMBER(38,0);

ALTER TABLE INTSO.EMPLOYEE ADD CONSTRAINT EMPLOYEE_UPDATED_BY_FK FOREIGN KEY(UPDATED_BY) REFERENCES INTSO.APP_USER(USER_SEQ_ID);

SELECT * FROM INTSO.DEPARTMENT;

insert into INTSO.DEPARTMENT values(01,'IT');
insert into INTSO.DEPARTMENT values(02,'HR');
insert into INTSO.DEPARTMENT values(03,'ADMIN');

ALTER TABLE INTSO.employee RENAME COLUMN EMP TO EMP_ID;
